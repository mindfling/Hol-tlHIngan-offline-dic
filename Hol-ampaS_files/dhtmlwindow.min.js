var dhtmlwindow={imagefiles:["images/min.gif","images/close.gif","images/restore.gif","images/resize.gif"],ajaxbustcache:!0,ajaxloadinghtml:"<b>Loading Page. Please wait...</b>",minimizeorder:0,zIndexvalue:100,tobjects:[],lastactivet:{},init:function(t){var e=document.createElement("div");e.id=t,e.className="dhtmlwindow";var i="";i='<div class="drag-handle">',i+='DHTML Window <div class="drag-controls"><img src="'+this.imagefiles[0]+'" title="Minimize" /><img src="'+this.imagefiles[1]+'" title="Close" /></div>',i+="</div>",i+='<div class="drag-contentarea"></div>',i+='<div class="drag-statusarea"><div class="drag-resizearea" style="background: transparent url('+this.imagefiles[3]+') top right no-repeat;">&nbsp;</div></div>',i+="</div>",e.innerHTML=i,document.getElementById("dhtmlwindowholder").appendChild(e);for(var t=document.getElementById(t),n=t.getElementsByTagName("div"),o=0;o<n.length;o++)/drag-/.test(n[o].className)&&(t[n[o].className.replace(/drag-/,"")]=n[o]);return t.handle._parent=t,t.resizearea._parent=t,t.controls._parent=t,t.onclose=function(){return!0},t.onmousedown=function(){dhtmlwindow.setfocus(this)},t.handle.onmousedown=dhtmlwindow.setupdrag,t.resizearea.onmousedown=dhtmlwindow.setupdrag,t.controls.onclick=dhtmlwindow.enablecontrols,t.show=function(){dhtmlwindow.show(this)},t.hide=function(){dhtmlwindow.hide(this)},t.close=function(){dhtmlwindow.close(this)},t.setSize=function(t,e){dhtmlwindow.setSize(this,t,e)},t.moveTo=function(t,e){dhtmlwindow.moveTo(this,t,e)},t.isResize=function(t){dhtmlwindow.isResize(this,t)},t.isScrolling=function(t){dhtmlwindow.isScrolling(this,t)},t.load=function(t,e,i){dhtmlwindow.load(this,t,e,i)},this.tobjects[this.tobjects.length]=t,t},open:function(t,e,i,n,o,s){function a(t){var e=new RegExp(t+"=([^,]+)","i");return e.test(o)?parseInt(RegExp.$1):0}t=null==document.getElementById(t)?this.init(t):document.getElementById(t),this.setfocus(t),t.setSize(a("width"),a("height"));var d=a("center")?"middle":a("left"),l=a("center")?"middle":a("top");return"undefined"!=typeof s&&"recal"==s&&0==this.scroll_top&&(window.attachEvent&&!window.opera?this.addEvent(window,function(){setTimeout(function(){t.moveTo(d,l)},400)},"load"):this.addEvent(window,function(){t.moveTo(d,l)},"load")),t.isResize(a("resize")),t.isScrolling(a("scrolling")),t.style.visibility="visible",t.style.display="block",t.contentarea.style.display="block",t.moveTo(d,l),t.load(e,i,n),"minimized"==t.state&&"Restore"==t.controls.firstChild.title&&(t.controls.firstChild.setAttribute("src",dhtmlwindow.imagefiles[0]),t.controls.firstChild.setAttribute("title","Minimize"),t.state="fullview"),t},setSize:function(t,e,i){t.style.width=Math.max(parseInt(e),150)+"px",t.contentarea.style.height=Math.max(parseInt(i),100)+"px"},moveTo:function(t,e,i){this.getviewpoint(),t.style.left="middle"==e?this.scroll_left+(this.docwidth-t.offsetWidth)/2+"px":this.scroll_left+parseInt(e)+"px",t.style.top="middle"==i?this.scroll_top+(this.docheight-t.offsetHeight)/2+"px":this.scroll_top+parseInt(i)+"px"},isResize:function(t,e){t.statusarea.style.display=e?"block":"none",t.resizeBool=e?1:0},isScrolling:function(t,e){t.contentarea.style.overflow=e?"auto":"hidden"},load:function(t,e,i,n){if(t.isClosed)return void alert("DHTML Window has been closed, so no window to load contents into. Open/Create the window again.");var e=e.toLowerCase();if("undefined"!=typeof n&&(t.handle.firstChild.nodeValue=n),"inline"==e)t.contentarea.innerHTML=i;else if("div"==e){var o=document.getElementById(i);t.contentarea.innerHTML=o.defaultHTML||o.innerHTML,o.defaultHTML||(o.defaultHTML=o.innerHTML),o.innerHTML="",o.style.display="none"}else"iframe"==e?(t.contentarea.style.overflow="hidden",t.contentarea.firstChild&&"IFRAME"==t.contentarea.firstChild.tagName||(t.contentarea.innerHTML='<iframe src="" style="margin:0; padding:0; width:100%; height: 100%" name="_iframe-'+t.id+'"></iframe>'),window.frames["_iframe-"+t.id].location.replace(i)):"ajax"==e&&this.ajax_connect(i,t);t.contentarea.datatype=e},setupdrag:function(t){var e=dhtmlwindow,i=this._parent;e.etarget=this;var t=window.event||t;return e.initmousex=t.clientX,e.initmousey=t.clientY,e.initx=parseInt(i.offsetLeft),e.inity=parseInt(i.offsetTop),e.width=parseInt(i.offsetWidth),e.contentheight=parseInt(i.contentarea.offsetHeight),"iframe"==i.contentarea.datatype&&(i.style.backgroundColor="#F8F8F8",i.contentarea.style.visibility="hidden"),document.onmousemove=e.getdistance,document.onmouseup=function(){"iframe"==i.contentarea.datatype&&(i.contentarea.style.backgroundColor="white",i.contentarea.style.visibility="visible"),e.stop()},!1},getdistance:function(t){var e=dhtmlwindow,i=e.etarget,t=window.event||t;return e.distancex=t.clientX-e.initmousex,e.distancey=t.clientY-e.initmousey,"drag-handle"==i.className?e.move(i._parent,t):"drag-resizearea"==i.className&&e.resize(i._parent,t),!1},getviewpoint:function(){var t=document.all&&!window.opera,e=document.documentElement&&parseInt(document.documentElement.clientWidth)||1e5;this.standardbody="CSS1Compat"==document.compatMode?document.documentElement:document.body,this.scroll_top=t?this.standardbody.scrollTop:window.pageYOffset,this.scroll_left=t?this.standardbody.scrollLeft:window.pageXOffset,this.docwidth=t?this.standardbody.clientWidth:/Safari/i.test(navigator.userAgent)?window.innerWidth:Math.min(e,window.innerWidth-16),this.docheight=t?this.standardbody.clientHeight:window.innerHeight},rememberattrs:function(t){this.getviewpoint(),t.lastx=parseInt(t.style.left||t.offsetLeft)-dhtmlwindow.scroll_left,t.lasty=parseInt(t.style.top||t.offsetTop)-dhtmlwindow.scroll_top,t.lastwidth=parseInt(t.style.width)},move:function(t,e){t.style.left=dhtmlwindow.distancex+dhtmlwindow.initx+"px",t.style.top=dhtmlwindow.distancey+dhtmlwindow.inity+"px"},resize:function(t,e){t.style.width=Math.max(dhtmlwindow.width+dhtmlwindow.distancex,150)+"px",t.contentarea.style.height=Math.max(dhtmlwindow.contentheight+dhtmlwindow.distancey,100)+"px"},enablecontrols:function(t){var e=dhtmlwindow,i=window.event?window.event.srcElement:t.target;return/Minimize/i.test(i.getAttribute("title"))?e.minimize(i,this._parent):/Restore/i.test(i.getAttribute("title"))?e.restore(i,this._parent):/Close/i.test(i.getAttribute("title"))&&e.close(this._parent),!1},minimize:function(t,e){dhtmlwindow.rememberattrs(e),t.setAttribute("src",dhtmlwindow.imagefiles[2]),t.setAttribute("title","Restore"),e.state="minimized",e.contentarea.style.display="none",e.statusarea.style.display="none","undefined"==typeof e.minimizeorder&&(dhtmlwindow.minimizeorder++,e.minimizeorder=dhtmlwindow.minimizeorder),e.style.left="10px",e.style.width="200px";var i=10*e.minimizeorder;e.style.top=dhtmlwindow.scroll_top+dhtmlwindow.docheight-e.handle.offsetHeight*e.minimizeorder-i+"px"},restore:function(t,e){dhtmlwindow.getviewpoint(),t.setAttribute("src",dhtmlwindow.imagefiles[0]),t.setAttribute("title","Minimize"),e.state="fullview",e.style.display="block",e.contentarea.style.display="block",e.resizeBool&&(e.statusarea.style.display="block"),e.style.left=parseInt(e.lastx)+dhtmlwindow.scroll_left+"px",e.style.top=parseInt(e.lasty)+dhtmlwindow.scroll_top+"px",e.style.width=parseInt(e.lastwidth)+"px"},close:function(t){try{var e=t.onclose()}catch(i){var e=!0}finally{if("undefined"==typeof e){alert('An error has occured somwhere inside your "onclose" event handler');var e=!0}}return e&&("minimized"!=t.state&&dhtmlwindow.rememberattrs(t),window.frames["_iframe-"+t.id]?window.frames["_iframe-"+t.id].location.replace("about:blank"):t.contentarea.innerHTML="",t.style.display="none",t.isClosed=!0),e},setopacity:function(t,e){t&&(t.filters&&t.filters[0]?"number"==typeof t.filters[0].opacity?t.filters[0].opacity=100*e:t.style.filter="alpha(opacity="+100*e+")":"undefined"!=typeof t.style.MozOpacity?t.style.MozOpacity=e:"undefined"!=typeof t.style.opacity&&(t.style.opacity=e))},setfocus:function(t){this.zIndexvalue++,t.style.zIndex=this.zIndexvalue,t.isClosed=!1,this.setopacity(this.lastactivet.handle,.5),this.setopacity(t.handle,1),this.lastactivet=t},show:function(t){return t.isClosed?void alert("DHTML Window has been closed, so nothing to show. Open/Create the window again."):(t.lastx?dhtmlwindow.restore(t.controls.firstChild,t):t.style.display="block",this.setfocus(t),void(t.state="fullview"))},hide:function(t){t.style.display="none"},ajax_connect:function(t,e){var i=!1,n="";if(window.XMLHttpRequest)i=new XMLHttpRequest;else{if(!window.ActiveXObject)return!1;try{i=new ActiveXObject("Msxml2.XMLHTTP")}catch(o){try{i=new ActiveXObject("Microsoft.XMLHTTP")}catch(o){}}}e.contentarea.innerHTML=this.ajaxloadinghtml,i.onreadystatechange=function(){dhtmlwindow.ajax_loadpage(i,e)},this.ajaxbustcache&&(n=-1!=t.indexOf("?")?"&"+(new Date).getTime():"?"+(new Date).getTime()),i.open("GET",t+n,!0),i.send(null)},ajax_loadpage:function(t,e){4!=t.readyState||200!=t.status&&-1!=window.location.href.indexOf("http")||(e.contentarea.innerHTML=t.responseText)},stop:function(){dhtmlwindow.etarget=null,document.onmousemove=null,document.onmouseup=null},addEvent:function(t,e,i){var i=window.addEventListener?i:"on"+i;t.addEventListener?t.addEventListener(i,e,!1):t.attachEvent&&t.attachEvent(i,e)},cleanup:function(){for(var t=0;t<dhtmlwindow.tobjects.length;t++)dhtmlwindow.tobjects[t].handle._parent=dhtmlwindow.tobjects[t].resizearea._parent=dhtmlwindow.tobjects[t].controls._parent=null;window.onload=null}};document.write('<div id="dhtmlwindowholder"><span style="display:none">.</span></div>'),window.onunload=dhtmlwindow.cleanup;
